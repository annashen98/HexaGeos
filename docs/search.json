[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Spatiotemporal Monitoring of Lake Cyanobacterial Blooms: A Case Study of Chaohu Lake",
    "section": "",
    "text": "Harmful algal blooms (HABs), particularly cyanobacterial blooms (CBs), are among the most critical environmental issues facing inland water bodies. These blooms pose significant threats to global public health and aquatic ecosystem stability. Chaohu Lake, the fifth-largest freshwater lake in China, faces severe eutrophication and frequent CBs due to agricultural runoff, industrial, and domestic pollution.\nRemote sensing technology enables real-time detection and long-term monitoring of CBs. This study focuses on Chaohu Lake as a case study, aiming to quantify and visualize the occurrence of CBs in the region over the past decade, providing insights into the impact of human activities on water quality and ecosystem health.\n\n\nThis application addresses two key research questions:\n\nWhat is the spatial distribution of cyanobacterial blooms (CBs) in Chaohu Lake?\nWhat temporal patterns characterize the occurrence of CBs in Chaohu Lake?\n\nBy leveraging remote sensing technology and indices, the application provides a cost-effective, real-time solution for quantifying and visualizing CB occurrences, enabling a deeper understanding of their spatial and temporal dynamics to inform management strategies.\n\n\n\nThis application is designed to serve environmental researchers, policymakers, local authorities, and residents in the Chaohu Lake region.\nFor researchers, it provides real-time monitoring of cyanobacterial blooms (CBs), offering insights into their spatial distribution and temporal patterns, which are essential for scientific analysis and environmental management.\nFor policymakers and local authorities, the tool enables data-driven decision-making to implement effective mitigation strategies, allocate resources efficiently, and establish long-term action plans to address water quality challenges.\nFor residents, the application raises awareness about water quality issues and associated health risks, empowering communities to take measures and engage in sustainability efforts.\n\n\n\nThis application uses Sentinel-2 MSI imagery from the Google Earth Engine platform. The image collection spans from 2018 to 2020 and is filtered for cloud coverage under 20%. Additionally, vegetation and water indices such as MNDWI, FAI, and TI are derived for analysis.\n\n\n\nWe use median composites and custom cloud masking for preprocessing. Water bodies are extracted using MNDWI, and bloom areas are identified by combining FAI and TI thresholds. We calculate bloom area statistics, classify bloom severity, and compute the Spatial Distribution Frequency Index (SDFI) for spatial analysis."
  },
  {
    "objectID": "index.html#project-summary",
    "href": "index.html#project-summary",
    "title": "Spatiotemporal Monitoring of Lake Cyanobacterial Blooms: A Case Study of Chaohu Lake",
    "section": "",
    "text": "Harmful algal blooms (HABs), particularly cyanobacterial blooms (CBs), are among the most critical environmental issues facing inland water bodies. These blooms pose significant threats to global public health and aquatic ecosystem stability. Chaohu Lake, the fifth-largest freshwater lake in China, faces severe eutrophication and frequent CBs due to agricultural runoff, industrial, and domestic pollution.\nRemote sensing technology enables real-time detection and long-term monitoring of CBs. This study focuses on Chaohu Lake as a case study, aiming to quantify and visualize the occurrence of CBs in the region over the past decade, providing insights into the impact of human activities on water quality and ecosystem health.\n\n\nThis application addresses two key research questions:\n\nWhat is the spatial distribution of cyanobacterial blooms (CBs) in Chaohu Lake?\nWhat temporal patterns characterize the occurrence of CBs in Chaohu Lake?\n\nBy leveraging remote sensing technology and indices, the application provides a cost-effective, real-time solution for quantifying and visualizing CB occurrences, enabling a deeper understanding of their spatial and temporal dynamics to inform management strategies.\n\n\n\nThis application is designed to serve environmental researchers, policymakers, local authorities, and residents in the Chaohu Lake region.\nFor researchers, it provides real-time monitoring of cyanobacterial blooms (CBs), offering insights into their spatial distribution and temporal patterns, which are essential for scientific analysis and environmental management.\nFor policymakers and local authorities, the tool enables data-driven decision-making to implement effective mitigation strategies, allocate resources efficiently, and establish long-term action plans to address water quality challenges.\nFor residents, the application raises awareness about water quality issues and associated health risks, empowering communities to take measures and engage in sustainability efforts.\n\n\n\nThis application uses Sentinel-2 MSI imagery from the Google Earth Engine platform. The image collection spans from 2018 to 2020 and is filtered for cloud coverage under 20%. Additionally, vegetation and water indices such as MNDWI, FAI, and TI are derived for analysis.\n\n\n\nWe use median composites and custom cloud masking for preprocessing. Water bodies are extracted using MNDWI, and bloom areas are identified by combining FAI and TI thresholds. We calculate bloom area statistics, classify bloom severity, and compute the Spatial Distribution Frequency Index (SDFI) for spatial analysis."
  },
  {
    "objectID": "index.html#the-application",
    "href": "index.html#the-application",
    "title": "Spatiotemporal Monitoring of Lake Cyanobacterial Blooms: A Case Study of Chaohu Lake",
    "section": "The Application",
    "text": "The Application"
  },
  {
    "objectID": "index.html#how-it-works",
    "href": "index.html#how-it-works",
    "title": "Spatiotemporal Monitoring of Lake Cyanobacterial Blooms: A Case Study of Chaohu Lake",
    "section": "How it Works",
    "text": "How it Works\nOur interactive web application offers an intuitive platform for exploring and analyzing the spatiotemporal patterns of cyanobacterial blooms in Lake Chaohu. Main features include:\n\nAlgal Bloom Intensity Layers: Select different severity levels (VCI_Lv2 to VCI_Lv6) to visualize spatial distribution patterns of cyanobacterial blooms for detailed hotspot analysis.\nDynamic Area Chart: Click “Generate Daily Algae Area Chart” to plot daily changes in bloom area and analyze temporal trends and peak periods.\nData Export Tools: Download daily, monthly, or yearly statistical data with one click for further analysis outside the platform.\nDate Slider: Use the slider to visualize bloom distribution for specific dates, supporting in-depth temporal inspection.\nLayer & Basemap Switching: Freely toggle between overlay layers (algae mask, FAI mean, SDFI, lake outline) and switch base maps (road or satellite) to fit different visualization needs.\nLegend: A color-coded legend explains each overlay for easy interpretation of map content.\nPoint Query: Click any point within the lake to inspect detailed bloom intensity at that location.\n\nAdditional interactive controls include:\n\nZoom & Pan: Use + / – buttons or drag the map to zoom in, zoom out, and navigate the study area.\nGeometry Import: Advanced users can import custom spatial features for targeted analysis.\nReset & Full-Screen: Quickly restore the default view or switch to full-screen for better visualization.\nLayer and Basemap Controls: Switch thematic layers and base maps from the top right panel for direct visual comparison.\n\nTogether, these interactive tools provide a powerful and user-friendly experience, enabling researchers, policymakers, and the public to monitor and understand cyanobacterial blooms in Lake Chaohu in real time.\n\n3.1 Data Processing\nIn this part, the code below defines Chaohu Lake’s rectangular study area, centers the map on it, filters Sentinel-2 images within a specific date range and cloud cover threshold, and creates a composite image for analysis.\n// define study area - Chaohu Lake\nvar chaohu = ee.Geometry.Polygon(\n  [[[117.220, 31.799],\n    [117.220, 31.387],\n    [117.937, 31.387],\n    [117.937, 31.799]]]);\n\n\n// set the center\nMap.centerObject(chaohu, 10);\n\n////////////////import data////////////////\n\n// set time range\nvar startDate = '2018-05-01';\nvar endDate = '2018-11-01';\n\n// import Sentinel-2 data and filter\nvar s2 = ee.ImageCollection('COPERNICUS/S2')\n  .filterBounds(chaohu)\n  .filterDate(startDate, endDate)\n  .filter(ee.Filter.lt('CLOUDY_PIXEL_PERCENTAGE', 20))\n  \nvar compositeImage = s2.mosaic(); //Synthesize images within the same time period\n\n\n3.2 遥感指数介绍\n为了有效识别蓝藻水华，我们计算并应用了三种关键遥感指数： 1. Modified Normalized Difference Water Index (MNDWI) 它用于区分水体与陆地，计算公式如下： \\[\n\\text{MNDWI} = \\frac{\\rho_{\\text{green}} - \\rho_{\\text{swir}}}{\\rho_{\\text{green}} + \\rho_{\\text{swir}}}\n\\] 其中：\\(\\rho_{\\text{Green}}\\) 为绿波段（B3）反射率，\\(\\rho_{\\text{SWIR}}\\) 为短波红外波段（B11）反射率。\n// 计算 MNDWI\nvar mndwi = medianComposite.normalizedDifference(['B3', 'B11']).rename('MNDWI');\n\nFloating Algae Index (FAI) FAI专门用于检测蓝藻水华，计算公式如下： \\[\n\\text{FAI} = \\rho_{\\text{nir}} - \\rho_{\\text{nir}}'\n\\] 其中\\(\\rho'_{\\text{NIR}}\\)是近红外波段的基线反射率，公式如下： \\[\n\\rho_{\\text{nir}}' = \\rho_{\\text{red}} + (\\rho_{\\text{swir}} - \\rho_{\\text{red}}) \\times \\frac{\\lambda_{\\text{nir}} - \\lambda_{\\text{red}}}{\\lambda_{\\text{swir}} - \\lambda_{\\text{red}}}\n\\]\n\n// 计算FAI\nvar nirPrime = red.add(\n  swir.subtract(red).multiply((833 - 664.5) / (1613.7 - 664.5))\n);\nvar fai = nir.subtract(nirPrime).rename('FAI');\n\n浊度指数（TI） 采用TI来排除高浊度水体对蓝藻水华的影响，公式如下： \\[\nTI = \\rho_{red} - \\rho_{green} - \\left( \\frac{\\rho_{nir} - \\rho_{green}}{2} \\right)\n\\]\n\n// 计算 TI\nvar ti = red.subtract(green).subtract(\n  nir.subtract(green.multiply(0.5))\n).rename('TI');\n完整的指数计算函数：\nfunction calculateIndices(image) {\n  // 归一化反射率\n  var green = image.select('B3').divide(10000);\n  var red = image.select('B4').divide(10000);\n  var nir = image.select('B8').divide(10000);\n  var swir = image.select('B11').divide(10000);\n  \n  // 计算FAI\n  var nirPrime = red.add(swir.subtract(red).multiply((833 - 664.5) / (1613.7 - 664.5)));\n  var fai = nir.subtract(nirPrime).rename('FAI');\n  \n  // 计算TI\n  var ti = red.subtract(green).subtract(nir.subtract(green.multiply(0.5))).rename('TI');\n  \n  // 添加波段并应用水体掩膜\n  return image.addBands(fai).addBands(ti).updateMask(waterMaskImage);\n}\n\n\n3.3 云掩膜处理\n云层在可见光-近红外波段的反射特性与蓝藻水华相似，会导致FAI值较高出现假阳性，因此需要进行去云操作。 云掩膜处理使用了两种特殊的光谱指数： \\(I_1 = \\frac{B1 - B7}{B1 + B7}\\)，当值 &gt; 0.08 时通常表示薄云 \\(I_2 = \\frac{B5 - B4}{B5 + B7}\\)，当值 &lt; 0.1 且I₁值较高时，可帮助识别薄云特征 首先，利用红波段（B4）反射率高于0.2的特性检测厚云区域；其次，通过气溶胶波段（B1）与红边3波段（B7）的比值指数（I1）及红边1波段（B5）与红波段的比值指数（I2）识别薄云和阴影，设定I1&gt;0.08且I2&lt;0.1的条件来剔除这些干扰像元；最后，将厚云和薄云检测结果结合，生成综合云掩膜，仅保留无云像元供后续分析。\nfunction maskCloud(image) {\n  // 归一化反射率\n  var b1 = image.select('B1').divide(10000); // 气溶胶 (442 nm)\n  var b4 = image.select('B4').divide(10000); // 红波段 (664 nm)\n  var b5 = image.select('B5').divide(10000); // 红边1 (704 nm)\n  var b7 = image.select('B7').divide(10000); // 红边3 (782 nm)\n  \n  // 基础云掩膜（B4 &gt; 0.2）\n  var cloudMask = b4.lt(0.2);\n  \n  // 薄云/阴影剔除\n  var I1 = b1.subtract(b7).divide(b1.add(b7)); // (B1-B7)/(B1+B7)\n  var I2 = b5.subtract(b4).divide(b5.add(b7)); // (B5-B4)/(B5+B7)\n  var thinCloudMask = I1.gt(0.08).and(I2.lt(0.1)).not();\n  \n  // 综合云掩膜\n  return image.updateMask(cloudMask.and(thinCloudMask));\n}\n\n\n3.4高浊度水体掩膜\n高浊度水体（如含大量泥沙或悬浮物）在光学特性上与蓝藻水华存在相似性，也可能导致假阳性误判。因此为了排除高浊度水体对蓝藻水华的影响，我们利用浊度指数（TI）进行掩膜处理。\n// 浊度掩膜（TI &gt; 0）\n  var ti = red.subtract(green).subtract(\n    nir.subtract(green).multiply(0.5)\n  ).rename('TI');\n我们使用TI &gt; 0作为蓝藻水华的判别条件之一，这有助于排除非藻类引起的高浊度水体的干扰。完整的处理流程如下：\n// 设置 MNDWI 阈值，生成水体掩膜\nvar waterMask = mndwi.gt(0.1).selfMask(); // MNDWI &gt; 0.1 表示水体\n\n// 将水体掩膜转换为矢量\nvar waterVector = waterMask.clip(chaohu).reduceToVectors({\n  geometryType: 'polygon',\n  reducer: ee.Reducer.countEvery(),\n  scale: 30,\n  maxPixels: 10e6,\n  bestEffort: true\n});\n\n// 过滤面积小于阈值的水体（单位：平方米）\nvar minArea = 1000000; // 保留面积大于1,000,000平方米的水域\nvar filteredWater = waterVector.filter(ee.Filter.gte('count', minArea));\n\n// 提取水体的边界并向内缓冲 20 米，去除水路交界地影响\nvar bufferedWaterOutline = filteredWater.map(function(feature) {\n  return feature.buffer(-20); // 向内缓冲 20 米\n});\n\n// 创建水体掩膜图像用于后续处理\nvar waterMaskImage = ee.Image().byte().paint({\n  featureCollection: filteredWater,\n  color: 1\n}).clip(chaohu);\n通过这一系列掩膜处理，我们可以有效地排除云、薄云、阴影以及高浊度水体的干扰，从而提高蓝藻水华检测的准确性。也就是说当一个像元同时满足 FAI &gt; -0.004和 TI ≤ 0时，标记为蓝藻水华；\nfunction detectAlgae(image) {\n  // 获取FAI和TI波段\n  var fai = image.select('FAI');\n  var ti = image.select('TI');\n  \n  // 蓝藻水华条件：FAI &gt; -0.004 且 TI ≤ 0\n  var algaeMask = fai.gt(-0.004).and(ti.lte(0));\n  \n  return image.addBands(algaeMask.rename('algae'));\n}\n\nvar s2WithAlgae = s2WithIndices.map(detectAlgae);\n\n\n3.5 时间与空间分析（SDFI）\n我们使用每日水华面积计算来进行时间分析，时间序列图表可以帮助我们分析水华季节规律（如夏季高发）或年际趋势（如治理效果评估）。\n// 计算每日蓝藻水华面积\nfunction calculateDailyBloomArea(image) {\n  var bloom = image.select('algae');\n  var area = bloom.multiply(ee.Image.pixelArea()).rename('bloom_area');\n  var date = image.date().format('YYYY-MM-dd');\n  \n  return ee.Feature(null, {\n    'date': date,\n    'bloom_area': area,\n    'system:time_start': image.get('system:time_start')\n  });\n}\nvar dailyStats = s2WithAlgae.map(calculateDailyBloomArea);\n为了量化蓝藻水华的时空动态特征，我们引入了空间分布频率指数（SDFI）指标来进行空间分析。 \\[\n\\text{SDFI} = \\frac{\\sum_{i=1}^{n} R_{i,\\text{bloom}}}{\\sum_{i=1}^{n} R_{i,\\text{bloom}} + \\sum_{i=1}^{n} R_{i,\\text{water}}} \\times 100\\%\n\\] SDFI是用来衡量某一地理位置上蓝藻水华发生频率的指标。它描述了在监测时间段内，一个像元上出现蓝藻水华的次数占总观测次数的百分比，本质上反映了蓝藻水华的易发性。\n// 计算SDFI\nvar bloomCollection = s2WithAlgae.select('algae');\nvar bloomSum = bloomCollection.sum();\nvar validCount = bloomCollection.count();\nvar sdfi = bloomSum.divide(validCount).multiply(100).rename('SDFI');\n根据SDFI的结果，我们可以识别高频水华区域，针对高频区加强治理。\n\n\n3.6 水华分级\n基于FAI值和红波段反射率，建立了蓝藻水华的分级系统将水华划分为5个等级（VCI_Lv2至VCI_Lv6），从而量化藻类聚集密度和生态风险。\nfunction classifyBloom(image) {\n  var fai = image.select('FAI');\n  var red = image.select('B4').divide(10000);\n  \n  // 分级标准\n  var lv2 = fai.gte(-0.004).and(fai.lt(0.1));    \n  var lv3 = fai.gte(0.1).and(fai.lt(0.15));      \n  var lv4 = fai.gte(0.15).and(fai.lt(0.2));      \n  var lv5 = fai.gte(0.2).and(red.lt(0.07));      \n  var lv6 = fai.gte(0.2).and(red.gte(0.07));     \n  \n  return image\n    .addBands(lv2.rename('VCI_Lv2'))\n    .addBands(lv3.rename('VCI_Lv3'))\n    .addBands(lv4.rename('VCI_Lv4'))\n    .addBands(lv5.rename('VCI_Lv5'))\n    .addBands(lv6.rename('VCI_Lv6'));\n}\nvar classified = s2WithAlgae.map(classifyBloom);\n\n\nReferences\n[1]Brooks, B.W., Lazorchak, J.M., Howard, M.D., Johnson, M.V.V., Morton, S.L., Perkins, D.A., Reavie, E.D., Scott, G.I., Smith, S.A. and Steevens, J.A., 2016. Are harmful algal blooms becoming the greatest inland water quality threat to public health and aquatic ecosystems?. Environmental toxicology and chemistry, 35(1), pp.6-13.\n[2]Jing, Y., Zhang, Y., Hu, M., Chu, Q. and Ma, R., 2019. MODIS-satellite-based analysis of long-term temporal-spatial dynamics and drivers of algal blooms in a plateau lake Dianchi, China. Remote Sensing, 11(21), p.2582.\n[3]Guo, H., Liu, H., Lyu, H., Bian, Y., Zhong, S., Li, Y., Miao, S., Yang, Z., Xu, J., Cao, J. and Li, Y., 2022. Is there any difference on cyanobacterial blooms patterns between Lake Chaohu and Lake Taihu over the last 20 years?. Environmental Science and Pollution Research, 29(27), pp.40941-40953.\n[4]Song, T., Xu, C., Yan, F. & Zhang, J. (2025) ‘Spatiotemporal Monitoring of Lake Cyanobacterial Blooms Based on Sentinel-2 Data’, China Environmental Monitoring, 41(1), pp. 214–224 [5]Hu, C., 2009. A novel ocean color index to detect floating algae in the global oceans. Remote Sensing of Environment, 113(10), pp.2118-2129."
  }
]