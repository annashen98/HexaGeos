{"title":"Spatiotemporal Monitoring of Lake Cyanobacterial Blooms: A Case Study of Chaohu Lake","markdown":{"headingText":"Spatiotemporal Monitoring of Lake Cyanobacterial Blooms: A Case Study of Chaohu Lake","containsRefs":false,"markdown":"\n## Project Summary \n\nHarmful algal blooms (HABs), particularly cyanobacterial blooms (CBs), are among the most critical environmental issues facing inland water bodies. These blooms pose significant threats to global public health and aquatic ecosystem stability. Chaohu Lake, the fifth-largest freshwater lake in China, faces severe eutrophication and frequent CBs due to agricultural runoff, industrial, and domestic pollution. \nRemote sensing technology enables real-time detection and long-term monitoring of CBs. This study focuses on Chaohu Lake as a case study, aiming to quantify and visualize the occurrence of CBs in the region over the past decade, providing insights into the impact of human activities on water quality and ecosystem health.\n\n### Problem Statement \n\nThis application addresses two key research questions: \n1. What is the spatial distribution of cyanobacterial blooms (CBs) in Chaohu Lake? \n2. What temporal patterns characterize the occurrence of CBs in Chaohu Lake? \nBy leveraging remote sensing technology and indices, the application provides a cost-effective, real-time solution for quantifying and visualizing CB occurrences, enabling a deeper understanding of their spatial and temporal dynamics to inform management strategies.\n\n### End User \n\nThis application is designed to serve environmental researchers, policymakers, local authorities, and residents in the Chaohu Lake region.\nFor researchers, it provides real-time monitoring of cyanobacterial blooms (CBs), offering insights into their spatial distribution and temporal patterns, which are essential for scientific analysis and environmental management.\nFor policymakers and local authorities, the tool enables data-driven decision-making to implement effective mitigation strategies, allocate resources efficiently, and establish long-term action plans to address water quality challenges.\nFor residents, the application raises awareness about water quality issues and associated health risks, empowering communities to take measures and engage in sustainability efforts. \n\n### Data\n\nWhat data are you using? \n\n### Methodology\n\nHow are you using this data to address the problem?\n\n### Interface\n\nHow does your application's interface work to address the needs of your end user?\n\n## The Application \n\nReplace the link below with the link to your application.\n\n:::{.column-page}\n\n<iframe src='https://ollielballinger.users.earthengine.app/view/turkey-earthquake' width='100%' height='700px'></iframe>\n\n:::\n## How it Works \n\n### 3.1 Data Processing\n\nIn this part, the code below defines Chaohu Lake's rectangular study area, centers the map on it, filters Sentinel-2 images within a specific date range and cloud cover threshold, and creates a composite image for analysis.\n\n```js\n// define study area - Chaohu Lake\nvar chaohu = ee.Geometry.Polygon(\n  [[[117.220, 31.799],\n    [117.220, 31.387],\n    [117.937, 31.387],\n    [117.937, 31.799]]]);\n\n\n// set the center\nMap.centerObject(chaohu, 10);\n\n////////////////import data////////////////\n\n// set time range\nvar startDate = '2025-04-01';\nvar endDate = '2025-04-19';\n\n// import Sentinel-2 data and filter\nvar s2 = ee.ImageCollection('COPERNICUS/S2')\n  .filterBounds(chaohu)\n  .filterDate(startDate, endDate)\n  .filter(ee.Filter.lt('CLOUDY_PIXEL_PERCENTAGE', 20))\n  \nvar compositeImage = s2.mosaic(); //Synthesize images within the same time period\n```\n\n### 3.2 Data Calculating\nFirstly, we need to identify water bodies in Chaohu Lake by calculating the Modified Normalized Difference Water Index(MNDWI), applying a threshold to create a water mask, and then vectorizing the water areas. \nIt filters out small water bodies, retaining larger regions for further analysis. The boundaries of the remaining water features are buffered inward by 20 meters to eliminate edge effects and improve accuracy in the water delineation. \nThis approach is designed to accurately define the lake's water boundaries for environmental monitoring.\n\n```\n// calculate MNDWI\n\nvar mndwi = compositeImage.normalizedDifference(['B3', 'B11']).rename('MNDWI');\n\n// set MNDWI threhold\nvar waterMask = mndwi.gt(0.1).selfMask(); // MNDWI > 0.1 represents water\n\n// Convert the water mask into a vector\nvar waterVector = waterMask.clip(chaohu).reduceToVectors({\n  geometryType: 'polygon',\n  reducer: ee.Reducer.countEvery(),\n  scale: 30,\n  maxPixels: 10e6, \n  bestEffort: true   \n});\n\n// filter water area less than the threshold (unit: square meters)\nvar minArea = 1000000; \n\nvar filteredWater = waterVector.filter(ee.Filter.gte('count', minArea)); \n\n\n// Extract the water body boundaries and buffer inward by 20 meters to remove the influence of the water-land interface\nvar bufferedWaterOutline = filteredWater.map(function(feature) {\n  var geometry = feature.geometry();\n  var bufferedGeometry = geometry.buffer(-20); \n  return ee.Feature(bufferedGeometry);\n});\n```\n\nSecondly, we use FAI index to identify cyanobacterial blooms. The formulas are as follow:\n$$ \\Large \\text{FAI} = \\rho_{\\text{nir}} - \\rho'_{\\text{nir}} $$\n$$ \\Large \\rho'_{\\text{nir}} = \\rho_{\\text{red}} + \\left( \\rho_{\\text{swir}} - \\rho_{\\text{red}} \\right) \\times \\frac{833 - 664.5}{1613.7 - 664.5} $$\n```\nvar calculateFAI = function(image) {\n  // import bands: B4, B8, B11\n  var red = image.select('B4'); // 664 nm\n  var nir = image.select('B8'); // 833 nm\n  var swir = image.select('B11'); // 1613 nm\n  \n  // calculate ρ'nir\n  var nirPrime = red.add(\n    swir.subtract(red).multiply((833 - 664.5) / (1613.7 - 664.5))\n  );\n  \n  // calculate FAI\n  var fai = nir.subtract(nirPrime).rename('FAI');\n  \n  // add FAI as new band\n  return image.addBands(fai).clip(bufferedWaterOutline);\n};\n\n// calculate FAI\nvar s2WithFAI = s2.map(calculateFAI);\n\n// check how many images are there in the time range\nvar imageCount = s2WithFAI.size();\nprint('Number of images is:', imageCount);\n\nif (imageCount.gt(0)) {\n  // calculate average value of FAI band\n  var FAIMean = s2WithFAI.select('FAI').mean();\n} else {\n  print('No images found.');\n}\n```\n\nYou can include images:\n\n![Pixelwise T-Test, 2018](images/beirut_change_2020.jpg)\n\nand math:\n$$ \\Large t = {\\frac{\\overline{x_1}-\\overline{x_2}} {\\sqrt{\\frac{s^2_1}{n_1} + \\frac{s^2_2}{n_2}}}} $$\n\n### References\n[1]Brooks, B.W., Lazorchak, J.M., Howard, M.D., Johnson, M.V.V., Morton, S.L., Perkins, D.A., Reavie, E.D., Scott, G.I., Smith, S.A. and Steevens, J.A., 2016. Are harmful algal blooms becoming the greatest inland water quality threat to public health and aquatic ecosystems?. Environmental toxicology and chemistry, 35(1), pp.6-13.\n[2]Jing, Y., Zhang, Y., Hu, M., Chu, Q. and Ma, R., 2019. MODIS-satellite-based analysis of long-term temporal-spatial dynamics and drivers of algal blooms in a plateau lake Dianchi, China. Remote Sensing, 11(21), p.2582.\n[3]Guo, H., Liu, H., Lyu, H., Bian, Y., Zhong, S., Li, Y., Miao, S., Yang, Z., Xu, J., Cao, J. and Li, Y., 2022. Is there any difference on cyanobacterial blooms patterns between Lake Chaohu and Lake Taihu over the last 20 years?. Environmental Science and Pollution Research, 29(27), pp.40941-40953.\n[4]Song, T., Xu, C., Yan, F. & Zhang, J. (2025) 'Spatiotemporal Monitoring of Lake Cyanobacterial Blooms Based on Sentinel-2 Data', China Environmental Monitoring, 41(1), pp. 214–224\n[5]Hu, C., 2009. A novel ocean color index to detect floating algae in the global oceans. Remote Sensing of Environment, 113(10), pp.2118-2129.\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"wrap","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","highlight-style":"monokai.theme","output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.450","book":{"title":"CASA0025 Final Assessment","author":"Group Name","date":"01/01/2024","chapters":["index.qmd"],"repo-actions":["edit"],"downloads":["pdf","epub"],"sharing":["twitter","facebook"],"favicon":"favicon.ico","sidebar":{"logo":"casa_logo.png"}},"theme":{"dark":"darkly","light":"cosmo"},"code-copy":true,"linkcolor":"#34a832"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}